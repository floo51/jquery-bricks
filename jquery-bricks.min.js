(function(e){e.bricks=function(t,n){var r={maxRowHeight:310,itemSelector:"img"};var i=this;i.settings={};var s=e(t),t=t;i.init=function(){i.settings=e.extend({},r,n);i.layout()};i.layout=function(){var n=e(i.settings.itemSelector,s);var r=t.getBoundingClientRect().width;var o=new Array;var u=-17;s.find(i.settings.itemSelector).each(function(){var t=e(this).width()/e(this).height();var n=i.settings.maxRowHeight-(e(this).outerHeight(true)-e(this).height());var r=t*n;e(this).height(n);e(this).width(r)});s.children("br").remove();for(var a=0;a<n.length;a++){var f=e(n[a]);var l=f.offset().left+f.outerWidth();if(l<=u){o.push(f);var c=0;var h=0;for(var p=0;p<o.length;p++){var d=e(o[p]);c+=d.innerWidth();h+=d.outerWidth(true)-d.innerWidth()}for(var p=0;p<o.length;p++){var d=e(o[p]);var v=d.width()/d.height();var m=d.outerHeight(true)-d.innerHeight();var g=(r-h)/(c/(i.settings.maxRowHeight-m));var y=v*g;d.height(g);d.width(y)}e(o[o.length-1]).after("<br/>");o=new Array;u=-17}else{u=l;o.push(f)}}};i.init()};e.fn.bricks=function(t){return this.each(function(){if(undefined==e(this).data("bricks")){var n=new e.bricks(this,t);e(this).data("bricks",n)}})}})(jQuery)